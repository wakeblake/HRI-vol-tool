<!DOCTYPE html>
<html lang="en">

  <head>
    <base target="_top">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <?!= include('CSS'); ?>
  </head>
  <body>

    <!-- TODO add back button functionality -->

    <div class="container-fluid vh-100 grad">

      <div class="container py-5" name="start">
        <p class="col text-center" id="pb-start"><input type="button" class="btn btn-primary" id="bstart" value="Start" onclick="startProcess()"></p>
      </div>

      <div class="container mt-5 d-none" id="presetup" name="presetup">
        <p class="text-left my-4" id="p-presetup">The active sheet <span id="sp-presetup"></span> has the following data settings: </p>
        <ul class="container px-4" id="prop-list">
        </ul>
        <p class="text-left my-4"><span><i class="text-danger">
          "Close" will deactivate this sheet and close the current report sheet. To avoid a lapse in client submissions, click "Update".
          </i></span>
        </p>
        <p class="col text-center" id="pb-no-setup">
          <input type="button" class="btn btn-primary mx-3 my-4" id="b-update" value="Update" onclick="updateActiveSheets(this)">
          <input type="button" class="btn btn-secondary" id="b-reset" value="Close" onclick="closeActiveSheets()">
        </p>
      </div>

      <div class="container py-5 d-none" id="sel-sheet" name="sel-sheet">
        <p class="col text-center" id="p-sel-sheet">Select the sheet you wish to set as the active protected sheet: </p>
        <form class="form-check" id="form-sel-sheet">
        </form>
        <br>
        <p class="col text-center" name="pb-sel-sheet" id="pb-sel-sheet">
          <input type="button" class="btn btn-primary disabled" id="b-sel-sheet" name="rb1" value="Next" onclick="getActiveSheetProperties(this)" disabled>
        </p>
      </div>

      <div class="container mt-5 d-none" id="show-props" name="show-props">
        <p class="text-left my-4" id="p-show-props"><span id="sp-show-props"></span> has the following data settings: </p>
        <ul class="container px-4" id="show-prop-list">
        </ul>
        <p class="text-center my-4">
          <span>Use these data settings?</span>
        </p>
        <p class="col text-center" id="pb-show-props">
          <input type="button" class="btn btn-primary my-4 mx-3" id="b-use-props" value="Yes" onclick="useSheetProperties(this)">
          <input type="button" class="btn btn-secondary" id="b-no-props" value="No" onclick="selectColumnName(this)">
        </p>
      </div>

      <div class="container py-5 col text-center d-none" id="cc-div">
        <p class="col text-center">Select cell with column name for case/client data and click "Next".</p>
        <br>
        <input type="button" class="btn btn-primary" id="ccb" name="ccb" value="Next" onclick="selectColumnName(this)">
      </div>

      <div class="container py-5 col text-center d-none" id="ec-div">
        <p class="col text-center">Select cell with column name for attorney email data and click "Next".</p>
        <br>
        <input type="button" class="btn btn-primary" id="ecb" name="ecb" value="Next" onclick="selectColumnName(this)">
      </div>

      <div class="container py-5 col text-center d-none" id="lfc-div">
        <p class="col text-center">Select cell with column name for law firm data and click "Next".</p>
        <br>
        <input type="button" class="btn btn-primary" id="lfb" name="lfb" value="Next" onclick="selectColumnName(this)">
      </div>

      <div class="container py-5 col text-center d-none" id="pbc-div">
        <p class="col text-center">Select cell with column name for pro bono attorney names and click "Next".</p>
        <br>
        <input type="button" class="btn btn-primary" id="pbb" name="pbb" value="Next" onclick="selectColumnName(this)">
      </div>

      <div class="container py-5 col text-center d-none" id="mec-div">
        <p class="col text-center">Select cell with column name for manager email data and click "Next".</p>
        <br>
        <input type="button" class="btn btn-primary" id="meb" name="meb" value="Next" onclick="selectColumnName(this)">
      </div>


      <div class="container py-5 d-none" id="sel-header" name="sel-header">
        <p class="text-center" id="p-sel-header">Select the column headings for user-facing reporting tables.<br><br>
          <span>
            <i class="text-danger">Exclude headings on which you do not wish users to report.</i>
          </span>
        </p>
        <br>
        <form class="form-check" id="form-sel-header">
        </form>
        <br>
        <p class="col text-center" id="pb-sel-header"><input type="button" class="btn btn-primary" id="b-sel-header" name="checkbox" value="Finish" onclick="finalizeActiveSheets()"></p>
      </div>

      <div class="container py-5 col text-center" name="loading">
        <div class="spinner-border text-primary d-none" id="loader" role="status"></div>
        <div class="container col py-5 text-center d-none" id="working">
          <p class="text-center">Activating your selected sheet . . .</p>
          <!--
          <p class="text-center d-none">Setting active sheet permissions and data validations . . .</p>
          -->
      </div>

      
      </div>

    </div>
  </body>
  <?!= include('AdminJS'); ?>

</html>




